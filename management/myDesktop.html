<!DOCTYPE html>
<html>
  
  <head>
    <meta charset="UTF-8">
    <title>绿色食品数字档案管理系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="./css/font.css">
    <link rel="stylesheet" href="./css/xadmin.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
      <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      .layui-card-body>div{ font-size: 16px;  display: inline-block; font-weight: bold; padding: 5px 10px; margin: 5px; border-radius: 5px; width: 15%; vertical-align: top; border: 1px solid #E6E6E6; background-color: #FAF7F7 }
      .layui-card-body>div>div{  font-size: 16px; }
      .layui-card-body>div>b{ background-color: #1E9FFF; color: white; padding: 5px 10px; border-radius: 5px;}
      .layui-card-body span, .layui-card-body b{font-size: 16px;}
      .layui-card-body{font-size: 16px; text-align: center}
    </style>
  </head>
  
  <body>
     
        <div class="x-nav">
          <span class="layui-breadcrumb">
            <a href="">首页</a>
            <a>
              <cite>本周食谱</cite></a>
          </span>
          <a class="layui-btn layui-btn-small layui-btn-normal" style="line-height:1.6em;margin-top:3px;float:right" href="javascript:location.replace(location.href);" title="刷新">
            <i class="layui-icon layui-icon-refresh-1" style="line-height:30px"></i></a>
        </div>
        <div class="x-body">
          
          <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
              <legend>上传本周食谱</legend>
          </fieldset>
          <button type="button" class="layui-btn layui-btn-normal" id="upload3" style="margin-left: 50px;"><i class="layui-icon"></i>选择文件</button>
          
          <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>职工餐</legend>
          </fieldset>
          <div style="padding: 20px; background-color: #F2F2F2; ">
            <div class="layui-row layui-col-space15">
              <div class="layui-col-md12">
                <div class="layui-card">
                  <div class="layui-card-body" >
                      <div id="monday">
                        <b>2019年5月20日(星期一)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="tuesday">
                        <b>2019年5月21日(星期二)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="wednesday">
                        <b>2019年5月22日(星期三)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="thursday">
                        <b>2019年5月23日(星期四)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="friday">
                        <b>2019年5月24日(星期五)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
          </div> 

          <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
            <legend>老年餐</legend>
          </fieldset>
          <div style="padding: 20px; background-color: #F2F2F2;">
            <div class="layui-row layui-col-space15">
              <div class="layui-col-md12">
                <div class="layui-card">
                  <div class="layui-card-body" >
                      <div id="monday_old">
                        <b>2019年5月20日(星期一)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="tuesday_old">
                        <b>2019年5月21日(星期二)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="wednesday_old">
                        <b>2019年5月22日(星期三)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="thursday_old">
                        <b>2019年5月23日(星期四)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                      <div id="friday_old">
                        <b>2019年5月24日(星期五)</b>
                        <div>
                            <div>番茄鸡蛋</div>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
          </div> 
          
          <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;"><legend>相关人员</legend></fieldset>

          <div style="padding: 20px; background-color: #F2F2F2;">
            <div class="layui-row layui-col-space15">
              
              <div class="layui-col-md6">
                <div class="layui-card">
                  <div class="layui-card-body">
                    <b>主管：</b><span id="chief"></span>
                  </div>
                </div>
              </div>
              <div class="layui-col-md6">
                <div class="layui-card">
                  <div class="layui-card-body">
                    <b>厨师长：</b><span id="chef"></span>
                  </div>
                </div>
              </div>
              
            </div>
          </div> 

        </div>
    
    <script src="common/server.js"></script>
    <script src="common/common.js"></script>
    <script id="layui" type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/xadmin.js"></script>
    <script>

       
        layui.use(['upload', 'form', 'laypage'], function(){

            let upload = layui.upload;
            let loadingIndex;
            upload.render({
              elem: '#upload3',
              url: Server.service.UploadExcel,
              accept: 'file',    //普通文件
              exts: 'xlsx',
              before: function(obj) {
                  loadingIndex = layer.load(2);  //显示加载层
              },
              done: function(res){
                  getWeekRecipe();
                  layer.close(loadingIndex);          //关闭加载层
                  return layer.msg(res.message);
              },
              error: function(){
                  return layer.msg('上传失败');
              }
            });
        
        });

        function getWeekRecipe() {   
            let getData = sendAjax(Server.service.GetWeekRecipe, {"draw": 1, 'start': 0, 'length': 100000, 'retrievalInfo': JSON.stringify({})} );
            let data = JSON.parse(getData.data);
            //console.log(data);
            $('#chief').html(data[0].Satrap);
            $('#chef').html(data[0].Chef);

            let [ele1, ele1_old, ele2, ele2_old, ele3, ele3_old, ele4, ele4_old, ele5, ele5_old] = ['','','','','','','','','',''];
            for(let i=0; i<data.length; i++){
              if(data[i].Week == '星期一' ) {
                  if(data[i].Type == '职工餐'){
                      $('#monday b').html(data[i].Date+'('+data[i].Week+')');
                      ele1 += `<div>${data[i].Name}</div>`
                  }else if(data[i].Type == '老年餐') {
                      $('#monday_old b').html(data[i].Date+'('+data[i].Week+')');
                      ele1_old += `<div>${data[i].Name}</div>`
                  }
              }else if(data[i].Week == '星期二') {
                  if(data[i].Type == '职工餐'){
                      $('#tuesday b').html(data[i].Date+'('+data[i].Week+')');
                      ele2 += `<div>${data[i].Name}</div>`
                  }else if(data[i].Type == '老年餐') {
                      $('#tuesday_old b').html(data[i].Date+'('+data[i].Week+')');
                      ele2_old += `<div>${data[i].Name}</div>`
                  } 
              }else if(data[i].Week == '星期三') {
                  if(data[i].Type == '职工餐'){
                      $('#wednesday b').html(data[i].Date+'('+data[i].Week+')');
                      ele3 += `<div>${data[i].Name}</div>`
                  }else if(data[i].Type == '老年餐') {
                      $('#wednesday_old b').html(data[i].Date+'('+data[i].Week+')');
                      ele3_old += `<div>${data[i].Name}</div>`
                  } 
              }else if(data[i].Week == '星期四') {
                  if(data[i].Type == '职工餐'){
                      $('#thursday b').html(data[i].Date+'('+data[i].Week+')');
                      ele4 += `<div>${data[i].Name}</div>`
                  }else if(data[i].Type == '老年餐') {
                      $('#thursday_old b').html(data[i].Date+'('+data[i].Week+')');
                      ele4_old += `<div>${data[i].Name}</div>`
                  } 
              }else if(data[i].Week == '星期五') {
                  if(data[i].Type == '职工餐'){
                      $('#friday b').html(data[i].Date+'('+data[i].Week+')');
                      ele5 += `<div>${data[i].Name}</div>`
                  }else if(data[i].Type == '老年餐') {
                      $('#friday_old b').html(data[i].Date+'('+data[i].Week+')');
                      ele5_old += `<div>${data[i].Name}</div>`
                  } 
              }
            }
            $('#monday div').html(ele1);
            $('#monday_old div').html(ele1_old);
            $('#tuesday div').html(ele2);
            $('#tuesday_old div').html(ele2_old);
            $('#wednesday div').html(ele3);
            $('#wednesday_old div').html(ele3_old);
            $('#thursday div').html(ele4);
            $('#thursday_old div').html(ele4_old);
            $('#friday div').html(ele5);
            $('#friday_old div').html(ele5_old);
          
        }
        getWeekRecipe()

    </script>

    
  


  </body>

</html>